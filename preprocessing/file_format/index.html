<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>1. File formatting - Fine-mapping Documentation</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "1. File formatting";
    var mkdocs_page_input_path = "preprocessing/file_format.md";
    var mkdocs_page_url = "/preprocessing/file_format/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Fine-mapping Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Introduction</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Data Preprocessing</span>
    <ul class="subnav">
                <li class=" current">
                    
    <a class="current" href="./">1. File formatting</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#file-formatting">File formatting</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#paintor">PAINTOR</a></li>
        
            <li><a class="toctree-l4" href="#fgwas">fgwas</a></li>
        
            <li><a class="toctree-l4" href="#caviar">CAVIAR</a></li>
        
            <li><a class="toctree-l4" href="#caviarbf">CAVIARBF</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../file_split/">2. File splitting</a>
                </li>
                <li class="">
                    
    <a class="" href="../ld_matrix_generation/">3. LD matrix generation</a>
                </li>
                <li class="">
                    
    <a class="" href="../functional_annotation_generation/">4. Functional annotation generation</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../software_running/">Software Running</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../caviarbf_c++/">CAVIARBF C++ version</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../caviarbf_R/">CAVIARBF R version</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../FINEMAP/">FINEMAP</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../reference/">Reference</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Fine-mapping Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Data Preprocessing &raquo;</li>
        
      
    
    <li>1. File formatting</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="file-formatting">File formatting<a class="headerlink" href="#file-formatting" title="Permanent link">&para;</a></h1>
<h2 id="paintor">PAINTOR<a class="headerlink" href="#paintor" title="Permanent link">&para;</a></h2>
<hr />
<h3 id="input-requirement">Input requirement<a class="headerlink" href="#input-requirement" title="Permanent link">&para;</a></h3>
<ul>
<li>Locus file (contain Zscore)</li>
<li>LD matrix file</li>
<li>Annotation matrix file</li>
</ul>
<p>For locus file, first line must be the header, only Zscore is required, other information could also be added.<br />
For LD matrix file, if you have the raw genotype data, you can generate the LD matrix yourself, but if you don't, you can use the 1000 Genome data as the reference and use the script provided by PAINTOR to generate the LD matrix<br />
Note: Snps in the locus file must be in the same order as in the LD matrix file and the annotation matrix file</p>
<h3 id="if-finemapping-alone">If finemapping alone<a class="headerlink" href="#if-finemapping-alone" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Header</th>
<th>Option</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr>
<td>Zscore</td>
<td><strong>required</strong></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="if-using-1000g-reference-to-generate-ld-matrix-most-common-case">If using 1000G reference to generate LD matrix (most common case)<a class="headerlink" href="#if-using-1000g-reference-to-generate-ld-matrix-most-common-case" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Header</th>
<th>Option</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr>
<td>chr</td>
<td><strong>required</strong></td>
<td></td>
</tr>
<tr>
<td>pos</td>
<td><strong>required</strong></td>
<td></td>
</tr>
<tr>
<td>effective allele</td>
<td><strong>required</strong></td>
<td></td>
</tr>
<tr>
<td>baseline allele</td>
<td><strong>required</strong></td>
<td></td>
</tr>
<tr>
<td>Zscore</td>
<td><strong>required</strong></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="fgwas">fgwas<a class="headerlink" href="#fgwas" title="Permanent link">&para;</a></h2>
<hr />
<h3 id="input-requirement_1">Input requirement<a class="headerlink" href="#input-requirement_1" title="Permanent link">&para;</a></h3>
<ul>
<li>Only one file containing both Zscore and functional annotation</li>
</ul>
<p>fgwas does <strong>NOT</strong> require a LD matrix file, but it require the Zscore and the annotations to be incorporated into <strong>ONE</strong> file. And all loci should be merged into <strong>ONE</strong> file and identified by a SEGNUMBER column.</p>
<p>In addition, it has different input requirement for quantitative trait and case-control trait  </p>
<h3 id="quantitative-trait">Quantitative trait<a class="headerlink" href="#quantitative-trait" title="Permanent link">&para;</a></h3>
<p>The columns have no enforced order, but are identified from the header  </p>
<h4 id="type-1">Type 1<a class="headerlink" href="#type-1" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Header</th>
<th>Option</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr>
<td>SNPID</td>
<td><strong>required</strong></td>
<td></td>
</tr>
<tr>
<td>CHR</td>
<td><strong>required</strong></td>
<td></td>
</tr>
<tr>
<td>POS</td>
<td><strong>required</strong></td>
<td></td>
</tr>
<tr>
<td>F</td>
<td><strong>required</strong></td>
<td>allele frequency of one of the alleles of the SNP</td>
</tr>
<tr>
<td>Z</td>
<td><strong>required</strong></td>
<td>Zscore</td>
</tr>
<tr>
<td>N</td>
<td><strong>required</strong></td>
<td>sample size</td>
</tr>
<tr>
<td>SEGNUMBER</td>
<td><strong>required</strong></td>
<td>each locus should have a unique SEGNUMBER, and the file should be ordered accordingly</td>
</tr>
<tr>
<td>annotation1</td>
<td>optional</td>
<td></td>
</tr>
<tr>
<td>annotation2</td>
<td>optional</td>
<td></td>
</tr>
<tr>
<td>...</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="type-2">Type 2<a class="headerlink" href="#type-2" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Header</th>
<th>Option</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr>
<td>SNPID</td>
<td><strong>required</strong></td>
<td></td>
</tr>
<tr>
<td>CHR</td>
<td><strong>required</strong></td>
<td></td>
</tr>
<tr>
<td>POS</td>
<td><strong>required</strong></td>
<td></td>
</tr>
<tr>
<td>F</td>
<td><strong>required but not used</strong></td>
<td>allele frequency of one of the alleles of the SNP</td>
</tr>
<tr>
<td>Z</td>
<td><strong>required</strong></td>
<td>Zscore</td>
</tr>
<tr>
<td>N</td>
<td><strong>required but not used</strong></td>
<td>sample size</td>
</tr>
<tr>
<td>SE</td>
<td><strong>required</strong></td>
<td>standard error</td>
</tr>
<tr>
<td>SEGNUMBER</td>
<td><strong>required</strong></td>
<td>each locus should have a unique SEGNUMBER, and the file should be ordered accordingly</td>
</tr>
<tr>
<td>annotation1</td>
<td>optional</td>
<td></td>
</tr>
<tr>
<td>annotation2</td>
<td>optional</td>
<td></td>
</tr>
<tr>
<td>...</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>for type 2, even though input SE will override F and N, you still need to add these two columns otherwise the program will raise an error. If you do not have the real value of F and N, you can add some pseudo values since they will not be used</p>
</div>
<h3 id="casecontrol-studies">Case/control studies<a class="headerlink" href="#casecontrol-studies" title="Permanent link">&para;</a></h3>
<h4 id="type-1_1">Type 1<a class="headerlink" href="#type-1_1" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Header</th>
<th>Option</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr>
<td>SNPID</td>
<td><strong>required</strong></td>
<td></td>
</tr>
<tr>
<td>CHR</td>
<td><strong>required</strong></td>
<td></td>
</tr>
<tr>
<td>POS</td>
<td><strong>required</strong></td>
<td></td>
</tr>
<tr>
<td>F</td>
<td><strong>required</strong></td>
<td>allele frequency of one of the alleles of the SNP</td>
</tr>
<tr>
<td>Z</td>
<td><strong>required</strong></td>
<td>Zscore</td>
</tr>
<tr>
<td>NCASE</td>
<td><strong>required</strong></td>
<td>number of cases used in the association study at this SNP</td>
</tr>
<tr>
<td>NCONTROL</td>
<td><strong>required</strong></td>
<td>number of controls used in the association study at this SNP</td>
</tr>
<tr>
<td>SEGNUMBER</td>
<td><strong>required</strong></td>
<td>each locus should have a unique SEGNUMBER, and the file should be ordered according to this column</td>
</tr>
<tr>
<td>annotation1</td>
<td>optional</td>
<td></td>
</tr>
<tr>
<td>annotation2</td>
<td>optional</td>
<td></td>
</tr>
<tr>
<td>...</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="type-2_1">Type 2<a class="headerlink" href="#type-2_1" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Header</th>
<th>Option</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr>
<td>SNPID</td>
<td><strong>required</strong></td>
<td></td>
</tr>
<tr>
<td>CHR</td>
<td><strong>required</strong></td>
<td></td>
</tr>
<tr>
<td>POS</td>
<td><strong>required</strong></td>
<td></td>
</tr>
<tr>
<td>F</td>
<td><strong>required but not used</strong></td>
<td>allele frequency of one of the alleles of the SNP</td>
</tr>
<tr>
<td>Z</td>
<td><strong>required</strong></td>
<td>Zscore</td>
</tr>
<tr>
<td>NCASE</td>
<td><strong>required but not used</strong></td>
<td>number of cases used in the association study at this SNP</td>
</tr>
<tr>
<td>NCONTROL</td>
<td><strong>required but not used</strong></td>
<td>number of controls used in the association study at this SNP</td>
</tr>
<tr>
<td>SE</td>
<td><strong>required</strong></td>
<td>standard error</td>
</tr>
<tr>
<td>SEGNUMBER</td>
<td><strong>required</strong></td>
<td>each locus should have a unique SEGNUMBER, and the file should be ordered according to this column</td>
</tr>
<tr>
<td>annotation1</td>
<td>optional</td>
<td></td>
</tr>
<tr>
<td>annotation2</td>
<td>optional</td>
<td></td>
</tr>
<tr>
<td>...</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For type 2, even though input SE will override F and NCASE and NCONTROL, you still need to add these two columns otherwise the program will raise an error. If you do not have the real value of F and N, you can add some pseudo values since they will not be used</p>
</div>
<h2 id="caviar">CAVIAR<a class="headerlink" href="#caviar" title="Permanent link">&para;</a></h2>
<hr />
<p>to be added</p>
<h2 id="caviarbf">CAVIARBF<a class="headerlink" href="#caviarbf" title="Permanent link">&para;</a></h2>
<hr />
<h3 id="c-version">C++ Version<a class="headerlink" href="#c-version" title="Permanent link">&para;</a></h3>
<h4 id="input-requirement_2">Input requirement<a class="headerlink" href="#input-requirement_2" title="Permanent link">&para;</a></h4>
<ul>
<li>Marginal test statistics file (Z-score file)</li>
<li>Correlation matrix file (LD matrix file)</li>
</ul>
<h4 id="example">Example<a class="headerlink" href="#example" title="Permanent link">&para;</a></h4>
<h5 id="z-score-file">Z-score file<a class="headerlink" href="#z-score-file" title="Permanent link">&para;</a></h5>
<p>This file should NOT contain header</p>
<pre><code>rs11922846 0.41199
rs2587938 -0.631405
rs1351949 0.269231
rs2587940 -0.786003
rs1825507 -0.514003
</code></pre>
<h5 id="ld-matrix-file">LD matrix file<a class="headerlink" href="#ld-matrix-file" title="Permanent link">&para;</a></h5>
<p>This file should NOT contain header</p>
<pre><code>1.0000e+00 3.4753e-01 1.0000e+00 3.4492e-01 4.3334e-01
3.4753e-01 1.0000e+00 3.4753e-01 9.8494e-01 -2.3178e-01
1.0000e+00 3.4753e-01 1.0000e+00 3.4492e-01 4.3334e-01
3.4492e-01 9.8494e-01 3.4492e-01 1.0000e+00 -2.3003e-01
4.3334e-01 -2.3178e-01 4.3334e-01 -2.3003e-01 1.0000e+00
</code></pre>
<h3 id="r-version">R Version<a class="headerlink" href="#r-version" title="Permanent link">&para;</a></h3>
<p>R version can incorporate functional annotations into fine-mapping process</p>
<h4 id="input-requirement_3">Input requirement<a class="headerlink" href="#input-requirement_3" title="Permanent link">&para;</a></h4>
<ul>
<li>Marginal test statistics file (Z-score file)</li>
<li>Correlation matrix file (LD matrix file)</li>
<li>Annotation file</li>
</ul>
<p>Naming of these three files are as follows:</p>
<ul>
<li>&lt;z-score-file></li>
<li>&lt;z-score-file>.LD </li>
<li>&lt;z-score-file>.annotations</li>
</ul>
<h4 id="example_1">Example<a class="headerlink" href="#example_1" title="Permanent link">&para;</a></h4>
<h5 id="naming">Naming<a class="headerlink" href="#naming" title="Permanent link">&para;</a></h5>
<p>gwas_summary_3_4750808.processed
gwas_summary_3_4750808.processed.LD
gwas_summary_3_4750808.processed.annotations</p>
<h5 id="z-score-file_1">Z-score file<a class="headerlink" href="#z-score-file_1" title="Permanent link">&para;</a></h5>
<p>This file should NOT contain header</p>
<pre><code>rs11922846 0.41199
rs2587938 -0.631405
rs1351949 0.269231
rs2587940 -0.786003
rs1825507 -0.514003
</code></pre>
<h5 id="ld-matrix-file_1">LD matrix file<a class="headerlink" href="#ld-matrix-file_1" title="Permanent link">&para;</a></h5>
<p>This file should NOT contain header</p>
<pre><code>1.0000e+00 3.4753e-01 1.0000e+00 3.4492e-01 4.3334e-01
3.4753e-01 1.0000e+00 3.4753e-01 9.8494e-01 -2.3178e-01
1.0000e+00 3.4753e-01 1.0000e+00 3.4492e-01 4.3334e-01
3.4492e-01 9.8494e-01 3.4492e-01 1.0000e+00 -2.3003e-01
4.3334e-01 -2.3178e-01 4.3334e-01 -2.3003e-01 1.0000e+00
</code></pre>
<h5 id="annotation-file">Annotation file<a class="headerlink" href="#annotation-file" title="Permanent link">&para;</a></h5>
<p>This file should NOT contain header, for CAVIARBF R version, annotations could be binary or continuous value.</p>
<p>This example has 7 annotations</p>
<pre><code>0 0 0 0 0 1 0
0 0 0 0 0 1 0
0 0 0 0 0 1 0
0 1 0 0 0 1 0
0 0 0 0 0 0 0
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../file_split/" class="btn btn-neutral float-right" title="2. File splitting">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../.." class="btn btn-neutral" title="Introduction"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Copyright © 2018 Hongcheng Yao</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../.." style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../file_split/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/require.js"></script>
      <script src="../../search/search.js"></script>

</body>
</html>
