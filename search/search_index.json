{
    "docs": [
        {
            "location": "/", 
            "text": "Introduction\n\n\n\n\nGeneral process of GWAS fine-mapping\n\n\nData preprocessing\n\n\nUsually this step is complex and time consuming, and this tutorial will \nfocus on this step\n\n\nPAINTOR\n\n\n\n\nFile formatting  \n\n\nFile splitting  \n\n\nLD matrix generation  \n\n\nFunctional annotation matrix generation  \n\n\n\n\nfgwas\n\n\n\n\nFile formatting\n\n\nFile splitting\n\n\nThe AnnotateLocus.py of PAINTOR is applied to SNPs from the same chromosome, so you either split the GWAS file into chromosomes or split it into loci in order to use AnnotateLocus.py to generate functional annotation matrix\n\n\nAlthough fgwas does not require LD matrix file, it's still necessary to define loci and assign SEGNUMBER to each locus\n\n\n\n\n\n\nFunctional annotation matrix generation\n\n\n\n\nSoftware running\n\n\nAfter the preprocessing, running fine-mapping software is usually straightforward\n\n\n\n\nSpecify parameters for different softwares", 
            "title": "Introduction"
        }, 
        {
            "location": "/#introduction", 
            "text": "", 
            "title": "Introduction"
        }, 
        {
            "location": "/#general-process-of-gwas-fine-mapping", 
            "text": "", 
            "title": "General process of GWAS fine-mapping"
        }, 
        {
            "location": "/#data-preprocessing", 
            "text": "Usually this step is complex and time consuming, and this tutorial will  focus on this step", 
            "title": "Data preprocessing"
        }, 
        {
            "location": "/#paintor", 
            "text": "File formatting    File splitting    LD matrix generation    Functional annotation matrix generation", 
            "title": "PAINTOR"
        }, 
        {
            "location": "/#fgwas", 
            "text": "File formatting  File splitting  The AnnotateLocus.py of PAINTOR is applied to SNPs from the same chromosome, so you either split the GWAS file into chromosomes or split it into loci in order to use AnnotateLocus.py to generate functional annotation matrix  Although fgwas does not require LD matrix file, it's still necessary to define loci and assign SEGNUMBER to each locus    Functional annotation matrix generation", 
            "title": "fgwas"
        }, 
        {
            "location": "/#software-running", 
            "text": "After the preprocessing, running fine-mapping software is usually straightforward   Specify parameters for different softwares", 
            "title": "Software running"
        }, 
        {
            "location": "/preprocessing/file_format/", 
            "text": "File formatting\n\n\nPAINTOR\n\n\n\n\nInput requirement\n\n\n\n\nLocus file (contain Zscore)\n\n\nLD matrix file\n\n\nAnnotation matrix file\n\n\n\n\nFor locus file, first line must be the header, only Zscore is required, other information could also be added.\n\nFor LD matrix file, if you have the raw genotype data, you can generate the LD matrix yourself, but if you don't, you can use the 1000 Genome data as the reference and use the script provided by PAINTOR to generate the LD matrix\n\nNote: Snps in the locus file must be in the same order as in the LD matrix file and the annotation matrix file\n\n\nIf finemapping alone\n\n\n\n\n\n\n\n\nHeader\n\n\nOption\n\n\nNote\n\n\n\n\n\n\n\n\n\n\nZscore\n\n\nrequired\n\n\n\n\n\n\n\n\n\n\nIf using 1000G reference to generate LD matrix (most common case)\n\n\n\n\n\n\n\n\nHeader\n\n\nOption\n\n\nNote\n\n\n\n\n\n\n\n\n\n\nchr\n\n\nrequired\n\n\n\n\n\n\n\n\npos\n\n\nrequired\n\n\n\n\n\n\n\n\neffective allele\n\n\nrequired\n\n\n\n\n\n\n\n\nbaseline allele\n\n\nrequired\n\n\n\n\n\n\n\n\nZscore\n\n\nrequired\n\n\n\n\n\n\n\n\n\n\nfgwas\n\n\n\n\nInput requirement\n\n\n\n\nOnly one file containing both Zscore and functional annotation\n\n\n\n\nfgwas does \nNOT\n require a LD matrix file, but it require the Zscore and the annotations to be incorporated into \nONE\n file. And all loci should be merged into \nONE\n file and identified by a SEGNUMBER column.\n\n\nIn addition, it has different input requirement for quantitative trait and case-control trait  \n\n\nQuantitative trait\n\n\nThe columns have no enforced order, but are identified from the header  \n\n\nType 1\n\n\n\n\n\n\n\n\nHeader\n\n\nOption\n\n\nNote\n\n\n\n\n\n\n\n\n\n\nSNPID\n\n\nrequired\n\n\n\n\n\n\n\n\nCHR\n\n\nrequired\n\n\n\n\n\n\n\n\nPOS\n\n\nrequired\n\n\n\n\n\n\n\n\nF\n\n\nrequired\n\n\nallele frequency of one of the alleles of the SNP\n\n\n\n\n\n\nZ\n\n\nrequired\n\n\nZscore\n\n\n\n\n\n\nN\n\n\nrequired\n\n\nsample size\n\n\n\n\n\n\nSEGNUMBER\n\n\nrequired\n\n\neach locus should have a unique SEGNUMBER, and the file should be ordered accordingly\n\n\n\n\n\n\nannotation1\n\n\noptional\n\n\n\n\n\n\n\n\nannotation2\n\n\noptional\n\n\n\n\n\n\n\n\n...\n\n\n\n\n\n\n\n\n\n\n\n\nType 2\n\n\n\n\n\n\n\n\nHeader\n\n\nOption\n\n\nNote\n\n\n\n\n\n\n\n\n\n\nSNPID\n\n\nrequired\n\n\n\n\n\n\n\n\nCHR\n\n\nrequired\n\n\n\n\n\n\n\n\nPOS\n\n\nrequired\n\n\n\n\n\n\n\n\nF\n\n\nrequired but not used\n\n\nallele frequency of one of the alleles of the SNP\n\n\n\n\n\n\nZ\n\n\nrequired\n\n\nZscore\n\n\n\n\n\n\nN\n\n\nrequired but not used\n\n\nsample size\n\n\n\n\n\n\nSE\n\n\nrequired\n\n\nstandard error\n\n\n\n\n\n\nSEGNUMBER\n\n\nrequired\n\n\neach locus should have a unique SEGNUMBER, and the file should be ordered accordingly\n\n\n\n\n\n\nannotation1\n\n\noptional\n\n\n\n\n\n\n\n\nannotation2\n\n\noptional\n\n\n\n\n\n\n\n\n...\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWarning\n\n\nfor type 2, even though input SE will override F and N, you still need to add these two columns otherwise the program will raise an error. If you do not have the real value of F and N, you can add some pseudo values since they will not be used\n\n\n\n\nCase/control studies\n\n\nType 1\n\n\n\n\n\n\n\n\nHeader\n\n\nOption\n\n\nNote\n\n\n\n\n\n\n\n\n\n\nSNPID\n\n\nrequired\n\n\n\n\n\n\n\n\nCHR\n\n\nrequired\n\n\n\n\n\n\n\n\nPOS\n\n\nrequired\n\n\n\n\n\n\n\n\nF\n\n\nrequired\n\n\nallele frequency of one of the alleles of the SNP\n\n\n\n\n\n\nZ\n\n\nrequired\n\n\nZscore\n\n\n\n\n\n\nNCASE\n\n\nrequired\n\n\nnumber of cases used in the association study at this SNP\n\n\n\n\n\n\nNCONTROL\n\n\nrequired\n\n\nnumber of controls used in the association study at this SNP\n\n\n\n\n\n\nSEGNUMBER\n\n\nrequired\n\n\neach locus should have a unique SEGNUMBER, and the file should be ordered according to this column\n\n\n\n\n\n\nannotation1\n\n\noptional\n\n\n\n\n\n\n\n\nannotation2\n\n\noptional\n\n\n\n\n\n\n\n\n...\n\n\n\n\n\n\n\n\n\n\n\n\nType 2\n\n\n\n\n\n\n\n\nHeader\n\n\nOption\n\n\nNote\n\n\n\n\n\n\n\n\n\n\nSNPID\n\n\nrequired\n\n\n\n\n\n\n\n\nCHR\n\n\nrequired\n\n\n\n\n\n\n\n\nPOS\n\n\nrequired\n\n\n\n\n\n\n\n\nF\n\n\nrequired but not used\n\n\nallele frequency of one of the alleles of the SNP\n\n\n\n\n\n\nZ\n\n\nrequired\n\n\nZscore\n\n\n\n\n\n\nNCASE\n\n\nrequired but not used\n\n\nnumber of cases used in the association study at this SNP\n\n\n\n\n\n\nNCONTROL\n\n\nrequired but not used\n\n\nnumber of controls used in the association study at this SNP\n\n\n\n\n\n\nSE\n\n\nrequired\n\n\nstandard error\n\n\n\n\n\n\nSEGNUMBER\n\n\nrequired\n\n\neach locus should have a unique SEGNUMBER, and the file should be ordered according to this column\n\n\n\n\n\n\nannotation1\n\n\noptional\n\n\n\n\n\n\n\n\nannotation2\n\n\noptional\n\n\n\n\n\n\n\n\n...\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWarning\n\n\nFor type 2, even though input SE will override F and NCASE and NCONTROL, you still need to add these two columns otherwise the program will raise an error. If you do not have the real value of F and N, you can add some pseudo values since they will not be used\n\n\n\n\nCAVIAR\n\n\n\n\nto be added\n\n\nCAVIARBF\n\n\n\n\nC++ Version\n\n\nInput requirement\n\n\n\n\nMarginal test statistics file (Z-score file)\n\n\nCorrelation matrix file (LD matrix file)\n\n\n\n\nExample\n\n\nZ-score file\n\n\nThis file should NOT contain header\n\n\nrs11922846 0.41199\nrs2587938 -0.631405\nrs1351949 0.269231\nrs2587940 -0.786003\nrs1825507 -0.514003\n\n\n\nLD matrix file\n\n\nThis file should NOT contain header\n\n\n1.0000e+00 3.4753e-01 1.0000e+00 3.4492e-01 4.3334e-01\n3.4753e-01 1.0000e+00 3.4753e-01 9.8494e-01 -2.3178e-01\n1.0000e+00 3.4753e-01 1.0000e+00 3.4492e-01 4.3334e-01\n3.4492e-01 9.8494e-01 3.4492e-01 1.0000e+00 -2.3003e-01\n4.3334e-01 -2.3178e-01 4.3334e-01 -2.3003e-01 1.0000e+00\n\n\n\nR Version\n\n\nR version can incorporate functional annotations into fine-mapping process\n\n\nInput requirement\n\n\n\n\nMarginal test statistics file (Z-score file)\n\n\nCorrelation matrix file (LD matrix file)\n\n\nAnnotation file\n\n\n\n\nNaming of these three files are as follows:\n\n\n\n\nz-score-file>\n\n\nz-score-file>.LD \n\n\nz-score-file>.annotations\n\n\n\n\nExample\n\n\nNaming\n\n\ngwas_summary_3_4750808.processed\ngwas_summary_3_4750808.processed.LD\ngwas_summary_3_4750808.processed.annotations\n\n\nZ-score file\n\n\nThis file should NOT contain header\n\n\nrs11922846 0.41199\nrs2587938 -0.631405\nrs1351949 0.269231\nrs2587940 -0.786003\nrs1825507 -0.514003\n\n\n\nLD matrix file\n\n\nThis file should NOT contain header\n\n\n1.0000e+00 3.4753e-01 1.0000e+00 3.4492e-01 4.3334e-01\n3.4753e-01 1.0000e+00 3.4753e-01 9.8494e-01 -2.3178e-01\n1.0000e+00 3.4753e-01 1.0000e+00 3.4492e-01 4.3334e-01\n3.4492e-01 9.8494e-01 3.4492e-01 1.0000e+00 -2.3003e-01\n4.3334e-01 -2.3178e-01 4.3334e-01 -2.3003e-01 1.0000e+00\n\n\n\nAnnotation file\n\n\nThis file should NOT contain header, for CAVIARBF R version, annotations could be binary or continuous value.\n\n\nThis example has 7 annotations\n\n\n0 0 0 0 0 1 0\n0 0 0 0 0 1 0\n0 0 0 0 0 1 0\n0 1 0 0 0 1 0\n0 0 0 0 0 0 0", 
            "title": "1. File formatting"
        }, 
        {
            "location": "/preprocessing/file_format/#file-formatting", 
            "text": "", 
            "title": "File formatting"
        }, 
        {
            "location": "/preprocessing/file_format/#paintor", 
            "text": "", 
            "title": "PAINTOR"
        }, 
        {
            "location": "/preprocessing/file_format/#input-requirement", 
            "text": "Locus file (contain Zscore)  LD matrix file  Annotation matrix file   For locus file, first line must be the header, only Zscore is required, other information could also be added. \nFor LD matrix file, if you have the raw genotype data, you can generate the LD matrix yourself, but if you don't, you can use the 1000 Genome data as the reference and use the script provided by PAINTOR to generate the LD matrix \nNote: Snps in the locus file must be in the same order as in the LD matrix file and the annotation matrix file", 
            "title": "Input requirement"
        }, 
        {
            "location": "/preprocessing/file_format/#if-finemapping-alone", 
            "text": "Header  Option  Note      Zscore  required", 
            "title": "If finemapping alone"
        }, 
        {
            "location": "/preprocessing/file_format/#if-using-1000g-reference-to-generate-ld-matrix-most-common-case", 
            "text": "Header  Option  Note      chr  required     pos  required     effective allele  required     baseline allele  required     Zscore  required", 
            "title": "If using 1000G reference to generate LD matrix (most common case)"
        }, 
        {
            "location": "/preprocessing/file_format/#fgwas", 
            "text": "", 
            "title": "fgwas"
        }, 
        {
            "location": "/preprocessing/file_format/#input-requirement_1", 
            "text": "Only one file containing both Zscore and functional annotation   fgwas does  NOT  require a LD matrix file, but it require the Zscore and the annotations to be incorporated into  ONE  file. And all loci should be merged into  ONE  file and identified by a SEGNUMBER column.  In addition, it has different input requirement for quantitative trait and case-control trait", 
            "title": "Input requirement"
        }, 
        {
            "location": "/preprocessing/file_format/#quantitative-trait", 
            "text": "The columns have no enforced order, but are identified from the header", 
            "title": "Quantitative trait"
        }, 
        {
            "location": "/preprocessing/file_format/#type-1", 
            "text": "Header  Option  Note      SNPID  required     CHR  required     POS  required     F  required  allele frequency of one of the alleles of the SNP    Z  required  Zscore    N  required  sample size    SEGNUMBER  required  each locus should have a unique SEGNUMBER, and the file should be ordered accordingly    annotation1  optional     annotation2  optional     ...", 
            "title": "Type 1"
        }, 
        {
            "location": "/preprocessing/file_format/#type-2", 
            "text": "Header  Option  Note      SNPID  required     CHR  required     POS  required     F  required but not used  allele frequency of one of the alleles of the SNP    Z  required  Zscore    N  required but not used  sample size    SE  required  standard error    SEGNUMBER  required  each locus should have a unique SEGNUMBER, and the file should be ordered accordingly    annotation1  optional     annotation2  optional     ...        Warning  for type 2, even though input SE will override F and N, you still need to add these two columns otherwise the program will raise an error. If you do not have the real value of F and N, you can add some pseudo values since they will not be used", 
            "title": "Type 2"
        }, 
        {
            "location": "/preprocessing/file_format/#casecontrol-studies", 
            "text": "", 
            "title": "Case/control studies"
        }, 
        {
            "location": "/preprocessing/file_format/#type-1_1", 
            "text": "Header  Option  Note      SNPID  required     CHR  required     POS  required     F  required  allele frequency of one of the alleles of the SNP    Z  required  Zscore    NCASE  required  number of cases used in the association study at this SNP    NCONTROL  required  number of controls used in the association study at this SNP    SEGNUMBER  required  each locus should have a unique SEGNUMBER, and the file should be ordered according to this column    annotation1  optional     annotation2  optional     ...", 
            "title": "Type 1"
        }, 
        {
            "location": "/preprocessing/file_format/#type-2_1", 
            "text": "Header  Option  Note      SNPID  required     CHR  required     POS  required     F  required but not used  allele frequency of one of the alleles of the SNP    Z  required  Zscore    NCASE  required but not used  number of cases used in the association study at this SNP    NCONTROL  required but not used  number of controls used in the association study at this SNP    SE  required  standard error    SEGNUMBER  required  each locus should have a unique SEGNUMBER, and the file should be ordered according to this column    annotation1  optional     annotation2  optional     ...        Warning  For type 2, even though input SE will override F and NCASE and NCONTROL, you still need to add these two columns otherwise the program will raise an error. If you do not have the real value of F and N, you can add some pseudo values since they will not be used", 
            "title": "Type 2"
        }, 
        {
            "location": "/preprocessing/file_format/#caviar", 
            "text": "to be added", 
            "title": "CAVIAR"
        }, 
        {
            "location": "/preprocessing/file_format/#caviarbf", 
            "text": "", 
            "title": "CAVIARBF"
        }, 
        {
            "location": "/preprocessing/file_format/#c-version", 
            "text": "", 
            "title": "C++ Version"
        }, 
        {
            "location": "/preprocessing/file_format/#input-requirement_2", 
            "text": "Marginal test statistics file (Z-score file)  Correlation matrix file (LD matrix file)", 
            "title": "Input requirement"
        }, 
        {
            "location": "/preprocessing/file_format/#example", 
            "text": "", 
            "title": "Example"
        }, 
        {
            "location": "/preprocessing/file_format/#z-score-file", 
            "text": "This file should NOT contain header  rs11922846 0.41199\nrs2587938 -0.631405\nrs1351949 0.269231\nrs2587940 -0.786003\nrs1825507 -0.514003", 
            "title": "Z-score file"
        }, 
        {
            "location": "/preprocessing/file_format/#ld-matrix-file", 
            "text": "This file should NOT contain header  1.0000e+00 3.4753e-01 1.0000e+00 3.4492e-01 4.3334e-01\n3.4753e-01 1.0000e+00 3.4753e-01 9.8494e-01 -2.3178e-01\n1.0000e+00 3.4753e-01 1.0000e+00 3.4492e-01 4.3334e-01\n3.4492e-01 9.8494e-01 3.4492e-01 1.0000e+00 -2.3003e-01\n4.3334e-01 -2.3178e-01 4.3334e-01 -2.3003e-01 1.0000e+00", 
            "title": "LD matrix file"
        }, 
        {
            "location": "/preprocessing/file_format/#r-version", 
            "text": "R version can incorporate functional annotations into fine-mapping process", 
            "title": "R Version"
        }, 
        {
            "location": "/preprocessing/file_format/#input-requirement_3", 
            "text": "Marginal test statistics file (Z-score file)  Correlation matrix file (LD matrix file)  Annotation file   Naming of these three files are as follows:   z-score-file>  z-score-file>.LD   z-score-file>.annotations", 
            "title": "Input requirement"
        }, 
        {
            "location": "/preprocessing/file_format/#example_1", 
            "text": "", 
            "title": "Example"
        }, 
        {
            "location": "/preprocessing/file_format/#naming", 
            "text": "gwas_summary_3_4750808.processed\ngwas_summary_3_4750808.processed.LD\ngwas_summary_3_4750808.processed.annotations", 
            "title": "Naming"
        }, 
        {
            "location": "/preprocessing/file_format/#z-score-file_1", 
            "text": "This file should NOT contain header  rs11922846 0.41199\nrs2587938 -0.631405\nrs1351949 0.269231\nrs2587940 -0.786003\nrs1825507 -0.514003", 
            "title": "Z-score file"
        }, 
        {
            "location": "/preprocessing/file_format/#ld-matrix-file_1", 
            "text": "This file should NOT contain header  1.0000e+00 3.4753e-01 1.0000e+00 3.4492e-01 4.3334e-01\n3.4753e-01 1.0000e+00 3.4753e-01 9.8494e-01 -2.3178e-01\n1.0000e+00 3.4753e-01 1.0000e+00 3.4492e-01 4.3334e-01\n3.4492e-01 9.8494e-01 3.4492e-01 1.0000e+00 -2.3003e-01\n4.3334e-01 -2.3178e-01 4.3334e-01 -2.3003e-01 1.0000e+00", 
            "title": "LD matrix file"
        }, 
        {
            "location": "/preprocessing/file_format/#annotation-file", 
            "text": "This file should NOT contain header, for CAVIARBF R version, annotations could be binary or continuous value.  This example has 7 annotations  0 0 0 0 0 1 0\n0 0 0 0 0 1 0\n0 0 0 0 0 1 0\n0 1 0 0 0 1 0\n0 0 0 0 0 0 0", 
            "title": "Annotation file"
        }, 
        {
            "location": "/preprocessing/file_split/", 
            "text": "File splitting\n\n\n\n\nThe idea of file splitting is to split the whole genome into loci. There are several ways to split the genome, and here the systematic way is to use the \napproximately independent LD block\n.  \n\n\nApproximately independent LD block\n\n\n\n\nRead the range of each LD block from the approximately independent LD block file with \nmatched population\n\n\nUse tabix to extract the SNPs from the GWAS file according to the LD block range\n\n\nFilter loci by Pvalue/Zscore since there are \nthousands\n of LD blocks  \n\n\n\n\nExample LD block file\n\n\nchr start stop\nchr1 10583 1892607\nchr1 1892607 3582736\nchr1 3582736 4380811\nchr1 4380811 5913893\n...\n\n\n\nExample code\n\n\n\n\nNote\n\n\nThis should not be used directly since it applies to specific files\n\n\n\n\n# comrepss the file using bgzip\nbgzip gwas_summary_temp_sorted\n# make index file using tabix\ntabix -s 1 -b 2 -e 2 -S 1 gwas_summary_temp_sorted.gz\n# extract range of LD block\ncat fourier_ls-all.bed | while read line\ndo\n    array=(${line})\n    chrnum=${array[0]#*chr}\n    chrnum=${chrnum// /}\n    start=${array[1]// /}\n    end=${array[2]// /}\n    if [ \n${start}\n != \nstart\n ]; then\n    # use tabix to extract the LD block from the GWAS file\n    tabix gwas_summary_temp_sorted.gz ${chrnum}:${start}-${end} \n output.${chrnum}_${start}_${end}\ndone\n\n\n\n\nOther methods\n\n\nIt is not necessary to split the genome into loci by approximately independent LD block. Sometimes people may just select the lead SNP and include SNPs within 500K bp of the lead SNP on both sides. If you have already define the loci somehow, it's OK to just skip this step.", 
            "title": "2. File splitting"
        }, 
        {
            "location": "/preprocessing/file_split/#file-splitting", 
            "text": "The idea of file splitting is to split the whole genome into loci. There are several ways to split the genome, and here the systematic way is to use the  approximately independent LD block .", 
            "title": "File splitting"
        }, 
        {
            "location": "/preprocessing/file_split/#approximately-independent-ld-block", 
            "text": "Read the range of each LD block from the approximately independent LD block file with  matched population  Use tabix to extract the SNPs from the GWAS file according to the LD block range  Filter loci by Pvalue/Zscore since there are  thousands  of LD blocks", 
            "title": "Approximately independent LD block"
        }, 
        {
            "location": "/preprocessing/file_split/#example-ld-block-file", 
            "text": "chr start stop\nchr1 10583 1892607\nchr1 1892607 3582736\nchr1 3582736 4380811\nchr1 4380811 5913893\n...", 
            "title": "Example LD block file"
        }, 
        {
            "location": "/preprocessing/file_split/#example-code", 
            "text": "Note  This should not be used directly since it applies to specific files   # comrepss the file using bgzip\nbgzip gwas_summary_temp_sorted\n# make index file using tabix\ntabix -s 1 -b 2 -e 2 -S 1 gwas_summary_temp_sorted.gz\n# extract range of LD block\ncat fourier_ls-all.bed | while read line\ndo\n    array=(${line})\n    chrnum=${array[0]#*chr}\n    chrnum=${chrnum// /}\n    start=${array[1]// /}\n    end=${array[2]// /}\n    if [  ${start}  !=  start  ]; then\n    # use tabix to extract the LD block from the GWAS file\n    tabix gwas_summary_temp_sorted.gz ${chrnum}:${start}-${end}   output.${chrnum}_${start}_${end}\ndone", 
            "title": "Example code"
        }, 
        {
            "location": "/preprocessing/file_split/#other-methods", 
            "text": "It is not necessary to split the genome into loci by approximately independent LD block. Sometimes people may just select the lead SNP and include SNPs within 500K bp of the lead SNP on both sides. If you have already define the loci somehow, it's OK to just skip this step.", 
            "title": "Other methods"
        }, 
        {
            "location": "/preprocessing/ld_matrix_generation/", 
            "text": "LD matrix generation\n\n\n\n\n\n\nNote\n\n\nSnps in the fine-mapping file should be in the same order as in the LD matrix file\n\n\n\n\nLD matrix generation using PAINTOR script\n\n\n\n\n\n\n\n\n\n\nHeader\n\n\nOption\n\n\nNote\n\n\n\n\n\n\n\n\n\n\nchr\n\n\nrequired\n\n\nUsed to choose the reference file\n\n\n\n\n\n\npos\n\n\nrequired\n\n\n\n\n\n\n\n\neffective allele\n\n\nrequired\n\n\n\n\n\n\n\n\nbaseline allele\n\n\nrequired\n\n\n\n\n\n\n\n\nZscore\n\n\nrequired\n\n\n\n\n\n\n\n\n1000g reference\n\n\nrequired\n\n\n\n\n\n\n\n\n1000g panel file\n\n\nrequired\n\n\n\n\n\n\n\n\npopulation ethnicity\n\n\nrequired\n\n\n\n\n\n\n\n\n\n\nUsually 1000 genome reference file are splitted into chromosomes, and CalcLD_1KG_VCF.py need to specify reference with matched chromosome\n\n\nExample code\n\n\n\n\nNote\n\n\nThis should not be used directly since it applies to specific files\n\n\n\n\n    python CalcLD_1KG_VCF.py\n    --locus gwas_summary_3_4750808.processed\n    --reference ALL.chr3.phase3_shapeit2_mvncall_integrated_v5a.20130502.genotypes.vcf.gz\n    --map integrated_call_samples_v3.20130502.ALL.panel\n    --effect_allele effect_allele\n    --alt_allele baseline_allele\n    --population EAS\n    --Zhead Zscore\n    --out_name gwas_summary_3_4750808.processed\n    --position pos\n\n\n\n\nLD matrix generation using raw genotype data and Plink\n\n\nto be added", 
            "title": "3. LD matrix generation"
        }, 
        {
            "location": "/preprocessing/ld_matrix_generation/#ld-matrix-generation", 
            "text": "Note  Snps in the fine-mapping file should be in the same order as in the LD matrix file", 
            "title": "LD matrix generation"
        }, 
        {
            "location": "/preprocessing/ld_matrix_generation/#ld-matrix-generation-using-paintor-script", 
            "text": "Header  Option  Note      chr  required  Used to choose the reference file    pos  required     effective allele  required     baseline allele  required     Zscore  required     1000g reference  required     1000g panel file  required     population ethnicity  required      Usually 1000 genome reference file are splitted into chromosomes, and CalcLD_1KG_VCF.py need to specify reference with matched chromosome", 
            "title": "LD matrix generation using PAINTOR script"
        }, 
        {
            "location": "/preprocessing/ld_matrix_generation/#example-code", 
            "text": "Note  This should not be used directly since it applies to specific files       python CalcLD_1KG_VCF.py\n    --locus gwas_summary_3_4750808.processed\n    --reference ALL.chr3.phase3_shapeit2_mvncall_integrated_v5a.20130502.genotypes.vcf.gz\n    --map integrated_call_samples_v3.20130502.ALL.panel\n    --effect_allele effect_allele\n    --alt_allele baseline_allele\n    --population EAS\n    --Zhead Zscore\n    --out_name gwas_summary_3_4750808.processed\n    --position pos", 
            "title": "Example code"
        }, 
        {
            "location": "/preprocessing/ld_matrix_generation/#ld-matrix-generation-using-raw-genotype-data-and-plink", 
            "text": "to be added", 
            "title": "LD matrix generation using raw genotype data and Plink"
        }, 
        {
            "location": "/preprocessing/functional_annotation_generation/", 
            "text": "Functional annotation generation\n\n\n\n\nThe generation of functional annotation matrix relies on two types of information (files)\n\n\n\n\nThe functional annotation bed files\n\n\nThe chromosome and position information of each SNP from GWAS summary data file\n\n\n\n\nIf using PAINTOR script to generate functional annotation matrix\n\n\n\n\n\n\n\n\nHeader\n\n\nOption\n\n\nNote\n\n\n\n\n\n\n\n\n\n\nchr\n\n\nrequired\n\n\n\n\n\n\n\n\npos\n\n\nrequired\n\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\n\nMake sure that the functional annotation bed file are sorted, because the AnnotateLocus.py script used a specific algorithm and unsorted functional annotation bed file will lead to wrong function annotation matrix.\n\n\nMake sure that the chromosome nomenclature is the same in the GWAS file and the functional annotation bed file. e.g. both should be chr1 or both should be 1\n\n\n\n\n\n\nExample code\n\n\n\n\nNote\n\n\nThis should not be used directly since it applies to specific files\n\n\n\n\n    python AnnotateLocus.py\n    --input annotation_paths_list\n    --locus gwas_summary_3_4750808.processed\n    --out gwas_summary_3_4750808.processed.annotations\n    --chr chr\n    --pos pos\n\n\n\n\nIf using bedtools to generate functional annotation matrix\n\n\nto be added", 
            "title": "4. Functional annotation generation"
        }, 
        {
            "location": "/preprocessing/functional_annotation_generation/#functional-annotation-generation", 
            "text": "The generation of functional annotation matrix relies on two types of information (files)   The functional annotation bed files  The chromosome and position information of each SNP from GWAS summary data file", 
            "title": "Functional annotation generation"
        }, 
        {
            "location": "/preprocessing/functional_annotation_generation/#if-using-paintor-script-to-generate-functional-annotation-matrix", 
            "text": "Header  Option  Note      chr  required     pos  required       Note   Make sure that the functional annotation bed file are sorted, because the AnnotateLocus.py script used a specific algorithm and unsorted functional annotation bed file will lead to wrong function annotation matrix.  Make sure that the chromosome nomenclature is the same in the GWAS file and the functional annotation bed file. e.g. both should be chr1 or both should be 1", 
            "title": "If using PAINTOR script to generate functional annotation matrix"
        }, 
        {
            "location": "/preprocessing/functional_annotation_generation/#example-code", 
            "text": "Note  This should not be used directly since it applies to specific files       python AnnotateLocus.py\n    --input annotation_paths_list\n    --locus gwas_summary_3_4750808.processed\n    --out gwas_summary_3_4750808.processed.annotations\n    --chr chr\n    --pos pos", 
            "title": "Example code"
        }, 
        {
            "location": "/preprocessing/functional_annotation_generation/#if-using-bedtools-to-generate-functional-annotation-matrix", 
            "text": "to be added", 
            "title": "If using bedtools to generate functional annotation matrix"
        }, 
        {
            "location": "/software_running/", 
            "text": "Software running\n\n\n\n\nAs abovementioned, after preprocessing, running fine-mapping software is usually straightforward and you are recommended to look through each software's documentation  \n\n\nPAINTOR\n\n\n\n\nExample code\n\n\npaintor -input input_loci_list\n-in input_dir\n-out output_dir\n-Zhead Zscore\n-LDname ld\n-enumerate 1\n-annotations annotation1,annotation2,annotation3\n\n\n\nfgwas\n\n\n\n\n\n\nNote\n\n\nfgwas does NOT allow SNPs to have the same position and it will raise an error. Make sure SNPs have unique position before using fgwas\n\n\n\n\nExample code\n\n\nfgwas -i input_file\n-fine\n-print\n-w annotation1+annotation2\n-o outputfile\n\n\n\nCAVIAR\n\n\n\n\nCAVIARBF", 
            "title": "Software Running"
        }, 
        {
            "location": "/software_running/#software-running", 
            "text": "As abovementioned, after preprocessing, running fine-mapping software is usually straightforward and you are recommended to look through each software's documentation", 
            "title": "Software running"
        }, 
        {
            "location": "/software_running/#paintor", 
            "text": "", 
            "title": "PAINTOR"
        }, 
        {
            "location": "/software_running/#example-code", 
            "text": "paintor -input input_loci_list\n-in input_dir\n-out output_dir\n-Zhead Zscore\n-LDname ld\n-enumerate 1\n-annotations annotation1,annotation2,annotation3", 
            "title": "Example code"
        }, 
        {
            "location": "/software_running/#fgwas", 
            "text": "Note  fgwas does NOT allow SNPs to have the same position and it will raise an error. Make sure SNPs have unique position before using fgwas", 
            "title": "fgwas"
        }, 
        {
            "location": "/software_running/#example-code_1", 
            "text": "fgwas -i input_file\n-fine\n-print\n-w annotation1+annotation2\n-o outputfile", 
            "title": "Example code"
        }, 
        {
            "location": "/software_running/#caviar", 
            "text": "", 
            "title": "CAVIAR"
        }, 
        {
            "location": "/software_running/#caviarbf", 
            "text": "", 
            "title": "CAVIARBF"
        }, 
        {
            "location": "/caviarbf_c++/", 
            "text": "CAVIARBF C++ version\n\n\nThe C++ version only works for \nSINGLE\n locus finemapping \nWITHOUT\n functional annotations.\n\n\n\n\nRunning process\n\n\n\n\nPrepare all the required files as in \nInput file format\n.\n\n\nRun executable program \ncaviarbf\n, and generate the Bayes factor file\n\n\nUse the Bayes factor file from former step and other files (if necessary), run executable program \nmodel_search\n, generate the final output files\n\n\n\n\nFor \ncaviarbf\n\n\nArgument\n\n\n\n\n-z\n (\nrequired\n) input file for marginal test statistics\n\n\n-i\n (\noptional\n) use the identity matrix for the correlation matrix, useful for c = 1\n\n\n-r\n input file for correlation matrix\n\n\nIf \n-i\n is used, i.e., use identity matrix for the correlation matrix, then there is no need to use \n-r\n to specify the input file for correlation matrix\n\n\nIf \n-i\n is not used, \n-r\n is \nrequired\n\n\n\n\n\n\n-t\n (\nrequired\n) prior type for variant effect size\n\n\n0: specify sigmaa, sigmaa relates to the variance of effect size\n\n\n1: specify the proportion of variance explained (pve)\n\n\nFor -t option, 0 (setting sigmaa) is fully tested. 1 is in an experimental stage. When using sigmaa, 0.1 seems to be a generally good value for -a for GWAS. Other values can be tried include 0.2, 0.4 as recommended by BIMBAM or use the robust multiple value version 0.1,0.2,0.4. For eQTL analysis, a multiple value option 0.1,0.2,0.4,0.8,1.6 is reasonable.\n\n\n\n\n\n\n-a\n (\nrequired\n) the prior values associated with the prior type\n\n\nOption \n-a\n now can support multiple values, for example, -a 0.1,0.2,0.4 to allow multiple values to be used and the final Bayes factor is an average among different values. This will be more robust when we are uncertain about the effect size.\n\n\n\n\n\n\n-n\n (\nrequired\n) the total number of samples in the data\n\n\n-c\n (\nrequired\n) the maximal number of causal variants in the model\n\n\nWhen running on many SNPs, be careful not to set the \n-c\n option too large because it may take too much time and also space to store the output. You can start with 1 or 2 and increase it by 1 in each trial. If two settings show similar results, then there is no need to increase it further.\n\n\n\n\n\n\n-o\n (\nrequired\n) the output file name for Bayes factors\n\n\n--appr\n (\noptional\n) calculate the approximated Bayes factors instead of the exact\n\n\nFor \nquanttatve trait\n, an \nexact\n Bayes factor can be calculated instead of an \napproximate\n Bayes factor. This is critical when the sample size is small or the effect size is large, for example, in expression quantitative trait loci (eQTL) analysis. To use the old approximate Bayes factors, use the option --appr. Use the \napproximate\n Bayes factor for a \nbinary trait\n because \nNO\n exact Bayes factor is available.\n\n\n\n\n\n\n-e\n (\noptional\n) the value added to the diagonal of the correlation matrix. A recommendded value is 0.1 when using estimated correlation, e.g., from the 1000 genomes project. This can improve the performance when the correlaton matrix is an approximaton, such as from a reference panel\n\n\nDefault: 0, if using exact Bayes factors\n\n\nDefault: 1e-3, if using approximated Bayes factors\n\n\n\n\n\n\n--\n Ignores the rest of the labeled arguments following this flag\n\n\n--version\n Displays version information and exits\n\n\n-h\n Displays usage information and exits\n\n\n\n\nInput file format\n\n\nInput requirement\n\n\n\n\nMarginal test statistics file (Z-score file, \nrequired\n)\n\n\nA text file with 2 or 3 columns separated by spaces\n\n\n\n\n\n\nCorrelation matrix file (LD matrix file, if use identity matrix for the correlation matrix, this is \nNOT\n necessary)\n\n\na matrix of the correlaton among variants\n\n\n\n\n\n\n\n\n\n\nNote\n\n\nThe coding scheme in the calculation of the correlation (LD) matrix should be consistent with that of the z scores, i.e., the allele coded as 1 in the calculation of z scores needs to be coded as 1 in the calculation of the correlation (LD) matrix and vice versa. Because this is how everything is calculated when we have the full genotype data: everything calculated is based on the same coding scheme. Otherwise the results using summary statistics may be arbitrary.\n\n\n\n\nExample\n\n\nMarginal test statistics file\n\n\nNote: This file should NOT contain header\n\n\nA text file with 2 or 3 columns separated by spaces. The third column is optional, which specifies the variance of each variant. In this case, we assume the effect size is not related to the allele frequency of the variant. The result will be similar to BIMBAM. Without the third column of variance of each variant, we assume that the effect size is larger when the minor allele frequency is smaller.\n\n\nrs11922846 0.41199\nrs2587938 -0.631405\nrs1351949 0.269231\nrs2587940 -0.786003\nrs1825507 -0.514003\n\n\n\nCorrelation matrix file\n\n\nNote: This file should NOT contain header\n\n\n1.0000e+00 3.4753e-01 1.0000e+00 3.4492e-01 4.3334e-01\n3.4753e-01 1.0000e+00 3.4753e-01 9.8494e-01 -2.3178e-01\n1.0000e+00 3.4753e-01 1.0000e+00 3.4492e-01 4.3334e-01\n3.4492e-01 9.8494e-01 3.4492e-01 1.0000e+00 -2.3003e-01\n4.3334e-01 -2.3178e-01 4.3334e-01 -2.3003e-01 1.0000e+00\n\n\n\nOutput file format\n\n\nThe output file is a text file with Bayes factors. It has the same format as that from BIMBAM. \n\n\nExample\n\n\nBayes factor file\n\n\nThe first line is a comment. The second line is the header. The first column is the Bayes factor. The rest columns indicate which SNPs/variants are in the model. NA means not in the model.\n\n\n## note:bf=log10(Bayes Factor), SNP IDs are from 1 ... m\nbf      se  snp1    snp2    snp3    snp4    snp5\n-0.591455   NA  1   NA  NA  NA  NA\n+4.658971   NA  2   NA  NA  NA  NA\n-0.127742   NA  3   NA  NA  NA  NA\n+7.052327   NA  4   NA  NA  NA  NA\n+1.289039   NA  5   NA  NA  NA  NA\n+2.519908   NA  6   NA  NA  NA  NA\n+9.619151   NA  1   2   NA  NA  NA\n-0.485480   NA  1   3   NA  NA  NA\n+6.794833   NA  1   4   NA  NA  NA\n+0.954240   NA  1   5   NA  NA  NA\n+2.145068   NA  1   6   NA  NA  NA\n+4.577784   NA  2   3   NA  NA  NA\n+12.322104  NA  2   4   NA  NA  NA\n+6.055098   NA  2   5   NA  NA  NA\n+7.274689   NA  2   6   NA  NA  NA\n+84.266736  NA  3   4   NA  NA  NA\n+1.568898   NA  3   5   NA  NA  NA\n+2.617624   NA  3   6   NA  NA  NA\n+7.998226   NA  4   5   NA  NA  NA\n+9.658610   NA  4   6   NA  NA  NA\n+3.923135   NA  5   6   NA  NA  NA\n\n\n\nFor \nmodel_search\n\n\nArgument\n\n\n\n\n-p\n (either \n-p\n or \n-f\n is \nrequired\n) the prior probability of each SNP being causal, in the range [0, 1). If it is 0, the prior probability will be set to 1 / m, where m is the number of variants in the region\n\n\n-f\n (either \n-p\n or \n-f\n is \nrequired\n) the file name specifying the prior probabilities of variants\n\n\n-i\n (\nrequired\n) input file storing Bayes factors\n\n\n-m\n (\nrequired\n) the total number of variants in the data\n\n\n-o\n (\nrequired\n) output file prefix\n\n\n-s\n output stepwise result with rho confidence level\n\n\n-e\n output exhaustive search result with rho confidence level\n\n\n-x\n output result first using exhaustive and then stepwise search with rho confidence level\n\n\n--\n Ignores the rest of the labeled arguments following this flag\n\n\n--version\n Displays version information and exits\n\n\n-h\n Displays usage information and exits\n\n\n\n\nInput file format\n\n\nInput requirement\n\n\n\n\nBayes factor file (\nrequired\n)\n\n\nThe output file from \ncaviarbf\n. Since the format is the same as the output from BIMBAM, it can also be used to process BIMBAM output Bayes factors\n\n\n\n\n\n\nPrior probability file (\noptional\n)\n\n\nThis file can be used to specify different priors of being causal for different variants. Each row corresponds to a variant in the region\n\n\nIf all the priors are the same, we can also use \n-p\n to specify the common prior directly\n\n\n\n\n\n\n\n\nExample\n\n\nPrior probability file\n\n\n0.02\n0.03\n0.02\n0.05\n0.02\n0.01\n\n\n\nOutput file format\n\n\n\n\nPosterior inclusion probability (PIP) file\n\n\nThe file has a .marginal suffix. It has two columns. The first column is the index of each variant in the data. The second is the PIP in a descending order\n\n\n\n\n\n\nStatistics file\n\n\nThis file has a .statistics suffix, and contains some statistics information. The first is the ratio between the likelihood of the data averaging over all models to the likelihood of the data under the global null model: no variant is causal. The second is the probability of at least 1 causal variant in the region. The third is the Bayes factor of the region (all alternative models vs. the global null model).\n\n\n\n\n\n\n\u03c1-confidence level file (when specify \n-s\n)\n\n\nThis file has a .stepwise suffix. It has the same format as the PIP file. Each row shows the \u03c1-confidence level when including the current variant and all variants above this row. To generate this file you need to specify the \n-s\n option\n\n\n\n\n\n\nOther experimental output files (when specify \n-e\n or \n-x\n)\n\n\n.exhaustive file outputs the best \u03c1-confidence level by exhaustive search of models for each model size. Due to the time cost, we only do that until model size 4. This needs the \n-e\n option to generate it.\n\n\n.exhaustivestepwise file outputs the \u03c1-confidence level by first applying the exhaustive search up to model size 4 and then switching to a stepwise search. This needs the \n-x\n option\n\n\n\n\n\n\n\n\nExplanation of \u03c1-confidence level file\n\n\nTBA", 
            "title": "CAVIARBF C++ version"
        }, 
        {
            "location": "/caviarbf_c++/#caviarbf-c-version", 
            "text": "The C++ version only works for  SINGLE  locus finemapping  WITHOUT  functional annotations.", 
            "title": "CAVIARBF C++ version"
        }, 
        {
            "location": "/caviarbf_c++/#running-process", 
            "text": "Prepare all the required files as in  Input file format .  Run executable program  caviarbf , and generate the Bayes factor file  Use the Bayes factor file from former step and other files (if necessary), run executable program  model_search , generate the final output files", 
            "title": "Running process"
        }, 
        {
            "location": "/caviarbf_c++/#for-caviarbf", 
            "text": "", 
            "title": "For caviarbf"
        }, 
        {
            "location": "/caviarbf_c++/#argument", 
            "text": "-z  ( required ) input file for marginal test statistics  -i  ( optional ) use the identity matrix for the correlation matrix, useful for c = 1  -r  input file for correlation matrix  If  -i  is used, i.e., use identity matrix for the correlation matrix, then there is no need to use  -r  to specify the input file for correlation matrix  If  -i  is not used,  -r  is  required    -t  ( required ) prior type for variant effect size  0: specify sigmaa, sigmaa relates to the variance of effect size  1: specify the proportion of variance explained (pve)  For -t option, 0 (setting sigmaa) is fully tested. 1 is in an experimental stage. When using sigmaa, 0.1 seems to be a generally good value for -a for GWAS. Other values can be tried include 0.2, 0.4 as recommended by BIMBAM or use the robust multiple value version 0.1,0.2,0.4. For eQTL analysis, a multiple value option 0.1,0.2,0.4,0.8,1.6 is reasonable.    -a  ( required ) the prior values associated with the prior type  Option  -a  now can support multiple values, for example, -a 0.1,0.2,0.4 to allow multiple values to be used and the final Bayes factor is an average among different values. This will be more robust when we are uncertain about the effect size.    -n  ( required ) the total number of samples in the data  -c  ( required ) the maximal number of causal variants in the model  When running on many SNPs, be careful not to set the  -c  option too large because it may take too much time and also space to store the output. You can start with 1 or 2 and increase it by 1 in each trial. If two settings show similar results, then there is no need to increase it further.    -o  ( required ) the output file name for Bayes factors  --appr  ( optional ) calculate the approximated Bayes factors instead of the exact  For  quanttatve trait , an  exact  Bayes factor can be calculated instead of an  approximate  Bayes factor. This is critical when the sample size is small or the effect size is large, for example, in expression quantitative trait loci (eQTL) analysis. To use the old approximate Bayes factors, use the option --appr. Use the  approximate  Bayes factor for a  binary trait  because  NO  exact Bayes factor is available.    -e  ( optional ) the value added to the diagonal of the correlation matrix. A recommendded value is 0.1 when using estimated correlation, e.g., from the 1000 genomes project. This can improve the performance when the correlaton matrix is an approximaton, such as from a reference panel  Default: 0, if using exact Bayes factors  Default: 1e-3, if using approximated Bayes factors    --  Ignores the rest of the labeled arguments following this flag  --version  Displays version information and exits  -h  Displays usage information and exits", 
            "title": "Argument"
        }, 
        {
            "location": "/caviarbf_c++/#input-file-format", 
            "text": "", 
            "title": "Input file format"
        }, 
        {
            "location": "/caviarbf_c++/#input-requirement", 
            "text": "Marginal test statistics file (Z-score file,  required )  A text file with 2 or 3 columns separated by spaces    Correlation matrix file (LD matrix file, if use identity matrix for the correlation matrix, this is  NOT  necessary)  a matrix of the correlaton among variants      Note  The coding scheme in the calculation of the correlation (LD) matrix should be consistent with that of the z scores, i.e., the allele coded as 1 in the calculation of z scores needs to be coded as 1 in the calculation of the correlation (LD) matrix and vice versa. Because this is how everything is calculated when we have the full genotype data: everything calculated is based on the same coding scheme. Otherwise the results using summary statistics may be arbitrary.", 
            "title": "Input requirement"
        }, 
        {
            "location": "/caviarbf_c++/#example", 
            "text": "", 
            "title": "Example"
        }, 
        {
            "location": "/caviarbf_c++/#marginal-test-statistics-file", 
            "text": "Note: This file should NOT contain header  A text file with 2 or 3 columns separated by spaces. The third column is optional, which specifies the variance of each variant. In this case, we assume the effect size is not related to the allele frequency of the variant. The result will be similar to BIMBAM. Without the third column of variance of each variant, we assume that the effect size is larger when the minor allele frequency is smaller.  rs11922846 0.41199\nrs2587938 -0.631405\nrs1351949 0.269231\nrs2587940 -0.786003\nrs1825507 -0.514003", 
            "title": "Marginal test statistics file"
        }, 
        {
            "location": "/caviarbf_c++/#correlation-matrix-file", 
            "text": "Note: This file should NOT contain header  1.0000e+00 3.4753e-01 1.0000e+00 3.4492e-01 4.3334e-01\n3.4753e-01 1.0000e+00 3.4753e-01 9.8494e-01 -2.3178e-01\n1.0000e+00 3.4753e-01 1.0000e+00 3.4492e-01 4.3334e-01\n3.4492e-01 9.8494e-01 3.4492e-01 1.0000e+00 -2.3003e-01\n4.3334e-01 -2.3178e-01 4.3334e-01 -2.3003e-01 1.0000e+00", 
            "title": "Correlation matrix file"
        }, 
        {
            "location": "/caviarbf_c++/#output-file-format", 
            "text": "The output file is a text file with Bayes factors. It has the same format as that from BIMBAM.", 
            "title": "Output file format"
        }, 
        {
            "location": "/caviarbf_c++/#example_1", 
            "text": "", 
            "title": "Example"
        }, 
        {
            "location": "/caviarbf_c++/#bayes-factor-file", 
            "text": "The first line is a comment. The second line is the header. The first column is the Bayes factor. The rest columns indicate which SNPs/variants are in the model. NA means not in the model.  ## note:bf=log10(Bayes Factor), SNP IDs are from 1 ... m\nbf      se  snp1    snp2    snp3    snp4    snp5\n-0.591455   NA  1   NA  NA  NA  NA\n+4.658971   NA  2   NA  NA  NA  NA\n-0.127742   NA  3   NA  NA  NA  NA\n+7.052327   NA  4   NA  NA  NA  NA\n+1.289039   NA  5   NA  NA  NA  NA\n+2.519908   NA  6   NA  NA  NA  NA\n+9.619151   NA  1   2   NA  NA  NA\n-0.485480   NA  1   3   NA  NA  NA\n+6.794833   NA  1   4   NA  NA  NA\n+0.954240   NA  1   5   NA  NA  NA\n+2.145068   NA  1   6   NA  NA  NA\n+4.577784   NA  2   3   NA  NA  NA\n+12.322104  NA  2   4   NA  NA  NA\n+6.055098   NA  2   5   NA  NA  NA\n+7.274689   NA  2   6   NA  NA  NA\n+84.266736  NA  3   4   NA  NA  NA\n+1.568898   NA  3   5   NA  NA  NA\n+2.617624   NA  3   6   NA  NA  NA\n+7.998226   NA  4   5   NA  NA  NA\n+9.658610   NA  4   6   NA  NA  NA\n+3.923135   NA  5   6   NA  NA  NA", 
            "title": "Bayes factor file"
        }, 
        {
            "location": "/caviarbf_c++/#for-model_search", 
            "text": "", 
            "title": "For model_search"
        }, 
        {
            "location": "/caviarbf_c++/#argument_1", 
            "text": "-p  (either  -p  or  -f  is  required ) the prior probability of each SNP being causal, in the range [0, 1). If it is 0, the prior probability will be set to 1 / m, where m is the number of variants in the region  -f  (either  -p  or  -f  is  required ) the file name specifying the prior probabilities of variants  -i  ( required ) input file storing Bayes factors  -m  ( required ) the total number of variants in the data  -o  ( required ) output file prefix  -s  output stepwise result with rho confidence level  -e  output exhaustive search result with rho confidence level  -x  output result first using exhaustive and then stepwise search with rho confidence level  --  Ignores the rest of the labeled arguments following this flag  --version  Displays version information and exits  -h  Displays usage information and exits", 
            "title": "Argument"
        }, 
        {
            "location": "/caviarbf_c++/#input-file-format_1", 
            "text": "", 
            "title": "Input file format"
        }, 
        {
            "location": "/caviarbf_c++/#input-requirement_1", 
            "text": "Bayes factor file ( required )  The output file from  caviarbf . Since the format is the same as the output from BIMBAM, it can also be used to process BIMBAM output Bayes factors    Prior probability file ( optional )  This file can be used to specify different priors of being causal for different variants. Each row corresponds to a variant in the region  If all the priors are the same, we can also use  -p  to specify the common prior directly", 
            "title": "Input requirement"
        }, 
        {
            "location": "/caviarbf_c++/#example_2", 
            "text": "", 
            "title": "Example"
        }, 
        {
            "location": "/caviarbf_c++/#prior-probability-file", 
            "text": "0.02\n0.03\n0.02\n0.05\n0.02\n0.01", 
            "title": "Prior probability file"
        }, 
        {
            "location": "/caviarbf_c++/#output-file-format_1", 
            "text": "Posterior inclusion probability (PIP) file  The file has a .marginal suffix. It has two columns. The first column is the index of each variant in the data. The second is the PIP in a descending order    Statistics file  This file has a .statistics suffix, and contains some statistics information. The first is the ratio between the likelihood of the data averaging over all models to the likelihood of the data under the global null model: no variant is causal. The second is the probability of at least 1 causal variant in the region. The third is the Bayes factor of the region (all alternative models vs. the global null model).    \u03c1-confidence level file (when specify  -s )  This file has a .stepwise suffix. It has the same format as the PIP file. Each row shows the \u03c1-confidence level when including the current variant and all variants above this row. To generate this file you need to specify the  -s  option    Other experimental output files (when specify  -e  or  -x )  .exhaustive file outputs the best \u03c1-confidence level by exhaustive search of models for each model size. Due to the time cost, we only do that until model size 4. This needs the  -e  option to generate it.  .exhaustivestepwise file outputs the \u03c1-confidence level by first applying the exhaustive search up to model size 4 and then switching to a stepwise search. This needs the  -x  option", 
            "title": "Output file format"
        }, 
        {
            "location": "/caviarbf_c++/#explanation-of-confidence-level-file", 
            "text": "TBA", 
            "title": "Explanation of \u03c1-confidence level file"
        }, 
        {
            "location": "/caviarbf_R/", 
            "text": "CAVIARBF R version\n\n\nSince the documentation of caviarbf is not clear enough and sometimes mixes with the documentation of the C++ version and the R version this documentation serves as a supplement\n\n\n\n\nDependencies\n\n\nThe R version depends on \nRcpp\n, \nRcppEigen\n and \nglmnet\n, remember to install these package before installing caviarbf \n\n\n\n\nWarning\n\n\nBy 2018-06-28, there is an error when using the lastest version of \nglmnet\n (2.0-16). According to the \nauthor's own explanation\n, \"This is a problem with the latest glmnet update. So far glmnet 2.0-10 seems to be working. I will try to see whether I can make it work with the latest glmnet (2.0-13)\"\n\n\nWhen testing with \nglmnet\n (2.0-10), there is no error\n\n\n\n\nSoftware Detail\n\n\nFollowing information are copied from caviarbf R package help directly\n\n\nPlease type \n?caviarbfFineMapping\n in R for the usage of the interface.\n\n\nUsage\n\n\ncaviarbfFineMapping(lociListFile, maxCausal, nSample, priorType01 = 0, \npriorValue = c(0.1, 0.2, 0.4), exact = T, eps = 0, useIdentityMatrix = F, \nBFFileListFile = NA, priorProb = 0, fittingMethod = \"glmnetLASSOMin\", \nhyperParamSelection = \"cv\", nFold = 5, K = 10, rThreshold = 0.2, \npvalueThreshold = 0.05, lambda = c(2^seq(from = -15, by = 2, to = 5), 100, 1000, 10000, 1e+05, 1e+06), \nalpha = c(0, 0.2, 0.3, 0.5, 0.7, 0.8, 1), annotationIndices = -1, \nannotationSuffix = \".annotations\", LDSuffix = \".LD\", outputPrefix, keepBF = F, \noverwriteExistingResults = F, maxIter = 50, deltaLik = 0.01, \nuseParallel = F, ncores = 1, verbose = F)\n\n\n\nArgument\n\n\n\n\n\n\nlociListFile\n A file listing all the z score files.\n\n\n\n\n\n\nmaxCausal\n The assumed maximal number of causal variants in each locus\n\n\n\n\n\n\nnSample\n The number of individuals used to calculate summary statistics\n\n\n\n\n\n\npriorType01\n 0 to specify sigmaa. An experimental 1 is used to specify the proportion of the phenotype variance explained (pve)\n\n\n\n\n\n\n\n\nIf \npriorType01 = 0\n\n\n\n\npriorValue\n If priorType01 is 0, it specifies the value of sigmaa. Otherwise, it is the pve value. For sigmaa, a vector of values can be used and the final Bayes factors are averaged. For GWAS fine mapping, c(0.1, 0.2, 0.4) might be a good option. For eQTL, c(0.1, 0.2, 0.4, 0.8, 1.6) might be a good option to accout for large eQTL effects.\n\n\n\n\n\n\n\n\n\n\nexact\n Whether to calculate the exact Bayes factors. This is \nonly\n valid for \nquantitative traits\n. For \nbinary traits\n, \nonly\n approximated Bayes factors are available\n\n\n\n\n\n\neps\n The small value to add to the correlation matrix. This is useful when the LD matrix is from a reference panel\n\n\n\n\n\n\nuseIdentityMatrix\n If true, use the identity matrix as the LD matrix. This improves the computing speed when only considering one causal variant for each locus\n\n\n\n\n\n\nBFFileListFile\n Specify the files of precomputed Bayes factors corresponding to each locus in the lociListFile. If NA, the Bayes factors will be calculated first. Bayes factors can precomputed for each locus using the C++ program This has the advantage of running in parallel, and can saved for later fine mapping.\n\n\n\n\n\n\npriorProb\n The initial probability of each variant being causal. If it is 0, the initial probability will be the number of loci divided by the number of all variants\n\n\n\n\n\n\nhyperParamSelection\n Method to select hyperparameter lambda and alpha. \n\"cv\"\n for loci based cross validation to select lambda and alpha, \n\"aic\"\n, \n\"bic\"\n, \n\"bic2\"\n uses AIC, BIC models. For the BIC model, \n\"bic2\"\n use the number of SNPs as the number of data points, \n\"bic\"\n uses the number of individuals as the number of data points, but they often show similar results. \n\"topK\"\n produces the top significant and relative independent annotations. No penalization is used in the fitting. As a by-product, it also outputs the pvalues for each individual annotation when considered separately\n\n\n\n\n\n\n\n\nIf \nhyperParamSelection = \"cv\"\n\n\n\n\n\n\nfittingMethod\n Specify different penalization models: \nglmnetLASSOMin\n for L1 penalization, \nglmnetRidgeMin\n for L2 penalization, \nglmnetENETMin\n for elastic net penalization. This is only used when \nhyperParamSelection\n is \n\"cv\"\n.\n\n\n\n\n\n\nalpha\n The alpha values for parameter selection, only used when the fitting method is \nglmnetENETMin\n\n\n\n\n\n\nnFold\n The fold of cross validation, only used when \nhyperParamSelection\n is \n\"cv\"\n. If the number of loci is less than then nFold, the number of loci is used\n\n\n\n\n\n\n\n\nIf \nhyperParamSelection = \"topK\"\n\n\n\n\nK\n Specify the top K annotations to select, used for \n\"topK\"\n\n\nrThreshold\n Specify the upper bound of the correlation among top annotations, used for \n\"topK\"\n\n\npvalueThreshold\n Specify the p value threshold for top annotations, used for \n\"topK\"\n\n\n\n\n\n\n\n\n\n\nlambda\n The lambda values for parameter selection. If lambda is 0, then no penalization is used in the fitting. This can be used for statistical testing, e.g., comparing two nested annotation models.\n\n\n\n\n\n\nannotationIndices\n A vector to specify annotations. If it is -1, use all annotations, 0 for only the intercept, otherwise it specifies the corresponding columns of annotations. Default uses all annotations.\n\n\n\n\n\n\nannotationSuffix\n The annotation suffix, default \".annotations\"\n\n\n\n\n\n\nLDSuffix\n The correlation file suffix, default \".LD\"\n\n\n\n\n\n\noutputPrefix\n The prefix of the output files\n\n\n\n\n\n\nkeepBF\n Whether to keep produced Bayes factor files\n\n\n\n\n\n\noverwriteExistingResults\n Whether to overwrite existing output files\n\n\n\n\n\n\nmaxIter\n The maximal iteration in the EM method\n\n\n\n\n\n\ndeltaLik\n The minimum improvement of log likelihood to continue the EM iteration\n\n\n\n\n\n\nuseParallel\n Whether to use library parallel to use multiple cores This can increase the speed of calculate PIPs in the EM iteration\n\n\n\n\n\n\nncores\n Number of cores to use in parallel when \nuseParallel\n is T\n\n\n\n\n\n\nverbose\n If true, more information are printed\n\n\n\n\n\n\nvalue\n\n\nThe results are saved in several files.  \n\n\noutputPrefix\n.marginal\n saves the indices of all variants following the order in the list file and the their PIPs sorted in a descring order.\n\n\noutputPrefix\n.marginalz\n includes the extra region index, the variant ID and the z score.\n\n\noutputPrefix\n.loglik\n stores the relative log likelihood.\n\n\noutputPrefix\n.gamma\n stores the estimated annotation effect size and the effect size of standardized annotation.\n\n\noutputPrefix\n.log\n stores the running log.\n\n\noutputPrefix\n.time\n saves the running time.\n\n\nNote\n\n\n\"topK\"\n First, annotations are ranked by their individual increase in likelihood compared to the model without any annotations. Then the top k annotations are used", 
            "title": "CAVIARBF R version"
        }, 
        {
            "location": "/caviarbf_R/#caviarbf-r-version", 
            "text": "Since the documentation of caviarbf is not clear enough and sometimes mixes with the documentation of the C++ version and the R version this documentation serves as a supplement", 
            "title": "CAVIARBF R version"
        }, 
        {
            "location": "/caviarbf_R/#dependencies", 
            "text": "The R version depends on  Rcpp ,  RcppEigen  and  glmnet , remember to install these package before installing caviarbf    Warning  By 2018-06-28, there is an error when using the lastest version of  glmnet  (2.0-16). According to the  author's own explanation , \"This is a problem with the latest glmnet update. So far glmnet 2.0-10 seems to be working. I will try to see whether I can make it work with the latest glmnet (2.0-13)\"  When testing with  glmnet  (2.0-10), there is no error", 
            "title": "Dependencies"
        }, 
        {
            "location": "/caviarbf_R/#software-detail", 
            "text": "Following information are copied from caviarbf R package help directly  Please type  ?caviarbfFineMapping  in R for the usage of the interface.", 
            "title": "Software Detail"
        }, 
        {
            "location": "/caviarbf_R/#usage", 
            "text": "caviarbfFineMapping(lociListFile, maxCausal, nSample, priorType01 = 0, \npriorValue = c(0.1, 0.2, 0.4), exact = T, eps = 0, useIdentityMatrix = F, \nBFFileListFile = NA, priorProb = 0, fittingMethod = \"glmnetLASSOMin\", \nhyperParamSelection = \"cv\", nFold = 5, K = 10, rThreshold = 0.2, \npvalueThreshold = 0.05, lambda = c(2^seq(from = -15, by = 2, to = 5), 100, 1000, 10000, 1e+05, 1e+06), \nalpha = c(0, 0.2, 0.3, 0.5, 0.7, 0.8, 1), annotationIndices = -1, \nannotationSuffix = \".annotations\", LDSuffix = \".LD\", outputPrefix, keepBF = F, \noverwriteExistingResults = F, maxIter = 50, deltaLik = 0.01, \nuseParallel = F, ncores = 1, verbose = F)", 
            "title": "Usage"
        }, 
        {
            "location": "/caviarbf_R/#argument", 
            "text": "lociListFile  A file listing all the z score files.    maxCausal  The assumed maximal number of causal variants in each locus    nSample  The number of individuals used to calculate summary statistics    priorType01  0 to specify sigmaa. An experimental 1 is used to specify the proportion of the phenotype variance explained (pve)     If  priorType01 = 0   priorValue  If priorType01 is 0, it specifies the value of sigmaa. Otherwise, it is the pve value. For sigmaa, a vector of values can be used and the final Bayes factors are averaged. For GWAS fine mapping, c(0.1, 0.2, 0.4) might be a good option. For eQTL, c(0.1, 0.2, 0.4, 0.8, 1.6) might be a good option to accout for large eQTL effects.      exact  Whether to calculate the exact Bayes factors. This is  only  valid for  quantitative traits . For  binary traits ,  only  approximated Bayes factors are available    eps  The small value to add to the correlation matrix. This is useful when the LD matrix is from a reference panel    useIdentityMatrix  If true, use the identity matrix as the LD matrix. This improves the computing speed when only considering one causal variant for each locus    BFFileListFile  Specify the files of precomputed Bayes factors corresponding to each locus in the lociListFile. If NA, the Bayes factors will be calculated first. Bayes factors can precomputed for each locus using the C++ program This has the advantage of running in parallel, and can saved for later fine mapping.    priorProb  The initial probability of each variant being causal. If it is 0, the initial probability will be the number of loci divided by the number of all variants    hyperParamSelection  Method to select hyperparameter lambda and alpha.  \"cv\"  for loci based cross validation to select lambda and alpha,  \"aic\" ,  \"bic\" ,  \"bic2\"  uses AIC, BIC models. For the BIC model,  \"bic2\"  use the number of SNPs as the number of data points,  \"bic\"  uses the number of individuals as the number of data points, but they often show similar results.  \"topK\"  produces the top significant and relative independent annotations. No penalization is used in the fitting. As a by-product, it also outputs the pvalues for each individual annotation when considered separately     If  hyperParamSelection = \"cv\"    fittingMethod  Specify different penalization models:  glmnetLASSOMin  for L1 penalization,  glmnetRidgeMin  for L2 penalization,  glmnetENETMin  for elastic net penalization. This is only used when  hyperParamSelection  is  \"cv\" .    alpha  The alpha values for parameter selection, only used when the fitting method is  glmnetENETMin    nFold  The fold of cross validation, only used when  hyperParamSelection  is  \"cv\" . If the number of loci is less than then nFold, the number of loci is used     If  hyperParamSelection = \"topK\"   K  Specify the top K annotations to select, used for  \"topK\"  rThreshold  Specify the upper bound of the correlation among top annotations, used for  \"topK\"  pvalueThreshold  Specify the p value threshold for top annotations, used for  \"topK\"      lambda  The lambda values for parameter selection. If lambda is 0, then no penalization is used in the fitting. This can be used for statistical testing, e.g., comparing two nested annotation models.    annotationIndices  A vector to specify annotations. If it is -1, use all annotations, 0 for only the intercept, otherwise it specifies the corresponding columns of annotations. Default uses all annotations.    annotationSuffix  The annotation suffix, default \".annotations\"    LDSuffix  The correlation file suffix, default \".LD\"    outputPrefix  The prefix of the output files    keepBF  Whether to keep produced Bayes factor files    overwriteExistingResults  Whether to overwrite existing output files    maxIter  The maximal iteration in the EM method    deltaLik  The minimum improvement of log likelihood to continue the EM iteration    useParallel  Whether to use library parallel to use multiple cores This can increase the speed of calculate PIPs in the EM iteration    ncores  Number of cores to use in parallel when  useParallel  is T    verbose  If true, more information are printed", 
            "title": "Argument"
        }, 
        {
            "location": "/caviarbf_R/#value", 
            "text": "The results are saved in several files.    outputPrefix .marginal  saves the indices of all variants following the order in the list file and the their PIPs sorted in a descring order.  outputPrefix .marginalz  includes the extra region index, the variant ID and the z score.  outputPrefix .loglik  stores the relative log likelihood.  outputPrefix .gamma  stores the estimated annotation effect size and the effect size of standardized annotation.  outputPrefix .log  stores the running log.  outputPrefix .time  saves the running time.", 
            "title": "value"
        }, 
        {
            "location": "/caviarbf_R/#note", 
            "text": "\"topK\"  First, annotations are ranked by their individual increase in likelihood compared to the model without any annotations. Then the top k annotations are used", 
            "title": "Note"
        }, 
        {
            "location": "/reference/", 
            "text": "Reference\n\n\n\n\nApproximately independent linkage disequilibrium blocks in human populations\n\n\nPaper: \nPickrell et al. Bioinformatics. 2016\n\nWebsite: \nhttps://bitbucket.org/nygcresearch/ldetect-data/src\n\n\nPAINTOR\n\n\nPaper: \nKichaev et al. PLOS Genetics, 2014\n, \nKichaev et al. American Journal of Human Genetics, 2015\n, \nKichaev et al. Bioinformatics, 2016\n\nWebsite: \nhttps://github.com/gkichaev/PAINTOR_V3.0\n\n\nfgwas\n\n\nPaper: \nPickrell American Journal of Human Genetics, 2014\n\nWebsite: \nhttps://github.com/joepickrell/fgwas\n\n\nCAVIAR\n\n\nPaper: \nHormozdiari et al. Genetics, 2014\n\nWebsite: \nhttp://genetics.cs.ucla.edu/caviar/\n\n\nCAVIARBF\n\n\nPaper: \nChen et al. Genetics, 2015\n\nWebsite: \nhttps://bitbucket.org/Wenan/caviarbf", 
            "title": "Reference"
        }, 
        {
            "location": "/reference/#reference", 
            "text": "", 
            "title": "Reference"
        }, 
        {
            "location": "/reference/#approximately-independent-linkage-disequilibrium-blocks-in-human-populations", 
            "text": "Paper:  Pickrell et al. Bioinformatics. 2016 \nWebsite:  https://bitbucket.org/nygcresearch/ldetect-data/src", 
            "title": "Approximately independent linkage disequilibrium blocks in human populations"
        }, 
        {
            "location": "/reference/#paintor", 
            "text": "Paper:  Kichaev et al. PLOS Genetics, 2014 ,  Kichaev et al. American Journal of Human Genetics, 2015 ,  Kichaev et al. Bioinformatics, 2016 \nWebsite:  https://github.com/gkichaev/PAINTOR_V3.0", 
            "title": "PAINTOR"
        }, 
        {
            "location": "/reference/#fgwas", 
            "text": "Paper:  Pickrell American Journal of Human Genetics, 2014 \nWebsite:  https://github.com/joepickrell/fgwas", 
            "title": "fgwas"
        }, 
        {
            "location": "/reference/#caviar", 
            "text": "Paper:  Hormozdiari et al. Genetics, 2014 \nWebsite:  http://genetics.cs.ucla.edu/caviar/", 
            "title": "CAVIAR"
        }, 
        {
            "location": "/reference/#caviarbf", 
            "text": "Paper:  Chen et al. Genetics, 2015 \nWebsite:  https://bitbucket.org/Wenan/caviarbf", 
            "title": "CAVIARBF"
        }
    ]
}